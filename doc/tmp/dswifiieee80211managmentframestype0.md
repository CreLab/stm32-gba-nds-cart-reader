# DS Wifi IEEE802.11 Managment Frames (Type=0)


All Managment Frames have 24-byte Frame Header, with following values:

```
+-----------------------------------------------------------------------+
|       FC(2), Duration(2), DA(6), SA(6), BSSID(6), Sequence Control(2) |
+-----------------------------------------------------------------------+
```

The content of the Frame Body depends on the FC\'s Subtype:

```
+-------------------------------------------------------------------------------------+
|       Subtype                   Frame Body                                          |
|       0 Association request     Capability, ListenInterval, SSID, SuppRates         |
|       1 Association response    Capability, Status, AID, SuppRates                  |
|       2 Reassociation request   Capability, ListenInterval, CurrAP, SSID, SuppRates |
|       3 Reassociation response  Capability, Status, AID, SuppRates                  |
|       4 Probe request           SSID, SuppRates                                     |
|       5 Probe response          Same as for Beacon (but without TIM)                |
|       8 Beacon                  Timestamp,BeaconInterval,Capability,SSID,SuppRates, |
|                                  FH Parameter Set (when using Frequency Hopping),   |
|                                  DS Parameter Set (when using Direct Sequence),     |
|                                  CF Parameter Set (when supporting PCF),            |
|                                  IBSS Parameter Set (when in an IBSS),              |
|                                  TIM (when generated by AP)                         |
|       9 Announcement traffic indication message (ATIM)    Body is "null" (=none?)   |
|       A Disassociation          ReasonCode                                          |
|       B Authentication          AuthAlgorithm, AuthSequence, Status, ChallengeText  |
|       C Deauthentication        ReasonCode                                          |
+-------------------------------------------------------------------------------------+
```

Subtypes 6..7, and D..F are Reserved.

### The separate components of the Frame Body are\...
64bit Parameters (8 bytes)

```
+----------------------------------------------------------------------------+
|       Timestamp: value of the TSFTIMER (see 11.1) of a frame's source. Uh? |
+----------------------------------------------------------------------------+
```

48bit Parameters (6 bytes)

```
+-------------------------------------------------------------------------------------+
|       Current AP (Access Point): MAC Address of AP with which station is associated |
+-------------------------------------------------------------------------------------+
```

16bit Parameters (2 bytes)

```
+------------------------------------------------------------------------------------+
|       Capability Information (see list below)                                      |
|       Status code (see list below) (0000h=Successful, other=Error code)            |
|       Reason code (see list below) (Error code)                                    |
|       Association ID (AID) (C000h+1..2007)                                         |
|       Authentication Algorithm (0=Open System, 1=Shared Key, 2..FFFFh=Reserved)    |
|       Authentication Transaction Sequence Number (Open System:1-2, Shared Key:1-4) |
|       Beacon Interval (Time between beacons, N*1024 us)                            |
|       Listen Interval (see note below)                                             |
+------------------------------------------------------------------------------------+
```

Information elements (1byte ID, 1byte LEN, followed by LEN byte(s) data)

```
+-------------------------------------------------------------------------------------+
|       ID      LEN      Expl.                                                        |
|       00h     00h-20h  SSID Service Set Identity (LEN=0 for broadcast SSID) (ASCII) |
|       01h     01h-08h  Supported rates; each (nn AND 7Fh)*500kbit/s, bit7=flag      |
|       02h     05h      FH (Frequency Hopping) Parameter Set                         |
|                          DwellTime(16bit), HopSet, HopPattern, HopIndex             |
|       03h     01h      DS (Distribution System) Parameter Set; Channel (01h..0Eh)   |
|       04h     06h      CF Parameter Set; Count, Period, MaxDuration, RemainDuration |
|       05h     04h..FEh TIM; Count,Period,Control, 1-251 bytes PartialVirtualBitmap  |
|       06h     02h      IBSS Parameter Set; ATIM Window length (16bit)               |
|       07h-0Fh -        Reserved                                                     |
|      (07h)    ..       802.11d Country                                              |
|      (08h)    ..       802.11d Hopping Pattern Params                               |
|      (09h)    ..       802.11d Hopping Pattern Table                                |
|      (0Ah)    ..       802.11d Request                                              |
|       10h     02h..FEh Challenge text; 1-253 bytes Authentication data              |
|                         (Used only for Shared Key sequence no 2,3)                  |
|                         (none such for Open System)                                 |
|                         (none such for Shared key sequence no 1,4)                  |
|       11h-1Fh -        Reserved for challenge text extension                        |
|       20h-FFh -        Reserved                                                     |
|      (20h)    ..       802.11h Power Constraint                                     |
|      (21h)    ..       802.11h Power Capability                                     |
|      (22h)    ..       802.11h TPC Request (Transmit Power Control)                 |
|      (23h)    ..       802.11h TPC Report                                           |
|      (24h)    ..       802.11h Supported Channels                                   |
|      (25h)    ..       802.11h Channel Switch Announcement                          |
|      (26h)    ..       802.11h Measurement Request                                  |
|      (27h)    ..       802.11h Measurement Report                                   |
|      (28h)    ..       802.11h Quiet                                                |
|      (29h)    ..       802.11h IBSS DFS                                             |
|       2Ah     ..       802.11g ERP Information (spotted in newer beacons)           |
|       30h     var      802.11i Reserved but used for WPA2 RSNIE <-- officially      |
|       32h     ..       802.11g Extended Supported Rates (spotted in newer beacons)  |
|       DDh     var      Reserved but used for WPA RSNIE  <-- vendor specific         |
|       DDh     var      Reserved but used by Nintendo for NDS-Multiboot beacons      |
|       2Dh     ..       Unknown (spotted in newer beacons)                           |
|       2Fh     ..       Unknown (spotted in newer beacons)                           |
|       3Dh     ..       Unknown (spotted in newer beacons)                           |
|       7Fh     ..       Unknown (spotted in newer beacons)                           |
+-------------------------------------------------------------------------------------+
```

IDs 20h-FFh are commonly used; I\'ve received values 2xh..3xh and DDh (from non-nintendo network routers in the neighborhood); no idea if these \"Reserved\" IDs are somewhere officially documented?

### Capability Information

```
+-----------------------------------------------------------------------+
|       Bit0    ESS                                                     |
|       Bit1    IBSS                                                    |
|       Bit2    CF-Pollable                                             |
|       Bit3    CF-Poll Request                                         |
|       Bit4    Privacy                                                 |
|       Bit5    Short Preamble  (IEEE802.11b only)                      |
|       Bit6    PBCC            (IEEE802.11b only)                      |
|       Bit7    Channel Agility (IEEE802.11b only)                      |
|       Bit5-7  Reserved (0) (original IEEE802.11 specs)                |
|       Bit8-15 Reserved (0)                                            |
+-----------------------------------------------------------------------+
```


### Listen Interval

```
+-----------------------------------------------------------------------------------+
|       ... used to indicate to the AP how often an STA wakes to listen to Beacon   |
|       management frames. The value of this parameter is the STA's Listen Interval |
|       parameter of the MLME-Associate. request primitive and is expressed in      |
|       units of Beacon Interval.                                                   |
+-----------------------------------------------------------------------------------+
```


### Reason codes

```
+-----------------------------------------------------------------------------------+
|       00h Reserved                                                                |
|       01h Unspecified reason                                                      |
|       02h Previous authentication no longer valid                                 |
|       03h Deauthenticated because sending station is leaving (or has left) IBSS   |
|            or ESS                                                                 |
|       04h Disassociated due to inactivity                                         |
|       05h Disassociated because AP is unable to handle all currently associated   |
|            stations                                                               |
|       06h Class 2 frame received from nonauthenticated station                    |
|       07h Class 3 frame received from nonassociated station                       |
|       08h Disassociated because sending station is leaving (or has left) BSS      |
|       09h Station requesting (re)association is not authenticated with responding |
|            station                                                                |
|       0Ah..FFFFh Reserved                                                         |
+-----------------------------------------------------------------------------------+
```


### Status codes

```
+-------------------------------------------------------------------------------------+
|       00h Successful                                                                |
|       01h Unspecified failure                                                       |
|       02h..09h Reserved                                                             |
|       0Ah Cannot support all requested cap's in the Capability Information field    |
|       0Bh Reassociation denied due to inability to confirm that association exists  |
|       0Ch Association denied due to reason outside the scope of this standard       |
|       0Dh Responding station doesn't support the specified authentication algorithm |
|       0Eh Received an Authentication frame with authentication transaction sequence |
|            number out of expected sequence                                          |
|       0Fh Authentication rejected because of challenge failure                      |
|       10h Authentication rejected due to timeout waiting for next frame in sequence |
|       11h Association denied because AP is unable to handle additional associated   |
|            stations                                                                 |
|       12h Association denied due to requesting station not supporting all of the    |
|            data rates in the BSSBasicRateSet parameter                              |
|       13h Association denied due to requesting station not supporting               |
|            the Short Preamble option (IEEE802.11b only)                             |
|       14h Association denied due to requesting station not supporting               |
|            the PBCC Modulation option (IEEE802.11b only)                            |
|       15h Association denied due to requesting station not supporting               |
|            the Channel Agility option (IEEE802.11b only)                            |
|       13h-15h Reserved (original IEEE802.11 specs)                                  |
|       16h..FFFFh Reserved                                                           |
+-------------------------------------------------------------------------------------+
```




