# DSi Atheros Wifi - Internal I/O - 00x000h - RTC/Clock WLAN (hw2/hw4/hw6)


**ATH:004004h/004004h/005004h - WLAN_XTAL_CONTROL ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0      TCXO                                                     |
+-----------------------------------------------------------------------+
```


**ATH:004010h/004010h/005010h - WLAN_QUADRATURE ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-1    h                                                        |
| w2/hw4: DAC (2bit)   ;\expanded DAC from 2bit (hw2/hw4) to 3bit (hw6) 
|       0-2    hw6:     DAC (3bit)   ; (and removed SEL bit in hw6)     |
|       2      hw2/hw4: SEL          ;/                                 |
|       4-5                                                             |
|    hw2:     ADC (2bit)   ;\expanded ADC from 2bit (hw2) to 4bit (hw4) 
|       4-7    hw4/hw6: ADC (4bit)   ;/                                 |
+-----------------------------------------------------------------------+
```


**ATH:004014h/004014h/005014h - WLAN_PLL_CONTROL ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-9    DIV                                                      |
|       12-15  hw2/hw4: REFDIV (4bit)                                   |
|       10-13  hw6:     REFDIV (4bit, now here)                         |
|       14-15  h                                                        |
| w6:     CLK_SEL ;<-- maybe replaces removed "SEL" in WLAN_QUADRATURE? |
|       16     BYPASS                                                   |
|       17     UPDATING                       (R)                       |
|       18     NOPWD                                                    |
|       19     MAC_OVERRIDE                                             |
|       20     DIG_TEST_CLK                                             |
+-----------------------------------------------------------------------+
```


**ATH:004018h/004018h/005018h - WLAN_PLL_SETTLE ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-11                                                            |
| hw2/hw4: TIME (12bit)          ;\decreased from 12bit to 11bit in hw6 
|       0-10   hw6:     TIME (11bit)          ;/                        |
+-----------------------------------------------------------------------+
```


**ATH:00401Ch/00401Ch/00501Ch - WLAN_XTAL_SETTLE ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-7                                                             |
|   hw2/hw4: TIME (8bit)           ;\decreased from 8bit to 7bit in hw6 
|       0-6    hw6:     TIME (7bit)           ;/                        |
+-----------------------------------------------------------------------+
```


**ATH:004020h/004020h/005020h - WLAN_CLOCK_OUT ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-3                                                             |
|     hw2/hw4: SELECT (4bit)         ;\raised from 4bit to 5bit in hw6, 
|       0-4                                                             |
|     hw6:     SELECT (5bit)         ; and added new DELAY field in hw6 |
|       5-7    hw6:     DELAY (3bit, new)     ;/                        |
+-----------------------------------------------------------------------+
```


**ATH:00402Ch/00402Ch/005024h - WLAN_BIAS_OVERRIDE ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0      ON                                                       |
+-----------------------------------------------------------------------+
```


**ATH:0040CCh/0040CCh/005030h - WLAN_MAC_SLEEP_CONTROL ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-1    hw2/hw4: ENABLE                ;\                        
|       0                                                               |
|     hw6:     ENABLE                ; reduced from 2bit to 1bit in hw6 |
|       1      hw6:     RESERVED              ;/                        |
|       2      hw6:     HSEL_WMAC_ENABLE      ;-new in hw6              |
+-----------------------------------------------------------------------+
```


**ATH:0040D0h/0040D0h/005034h - WLAN_KEEP_AWAKE ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-7    COUNT                                                    |
+-----------------------------------------------------------------------+
```


**ATH:0040F0h/0040F0h/005038h - WLAN_DERIVED_RTC_CLK ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       1-15   PERIOD                                                   |
|                                                                       |
| 16-17  hw2/hw4: FORCE                 ;-hw2/hw4 only (removed in hw6) |
|       18     EXTERNAL_DETECT            (R)                           |
|       20     EXTERNAL_DETECT_EN                                       |
+-----------------------------------------------------------------------+
```



```
+-----------------------------------------------------------------------+
|      _______                                                          |
| _________________ SLP or SLOP or SLEEP or so ________________________ |
+-----------------------------------------------------------------------+
```


**ATH:0040F4h/0040F4h/00503Ch - MAC_PCU_SLP32_MODE ;hw2/hw4/hw6**
**ATH:028244h (mirror of 0040F4h) - MAC_PCU_REG_SLP32_MODE (ini:10F424h)
;hw2**

```
+-----------------------------------------------------------------------+
|       0-19   HALF_CLK_LATENCY                                         |
|       20                                                              |
|  ENABLE    ;<-- see hw2 note    ;-hw2/hw4/hw6 (on hw2 in mirror only) |
|                                                                       |
|    21     hw2:     TSF_WRITE_PENDING     ;\changed/renamed in hw2/hw4 
|       21     hw4/hw6: TSF_WRITE_STATUS  (R) ;/                        |
|       22     hw4/hw6: DISABLE_32KHZ         ;\                        
|       23                                                              |
|    hw4/hw6: FORCE_BIAS_BLOCK_ON   ; hw4/hw6 only (unspecified in hw2) |
|       24     hw4/hw6: TSF2_WRITE_STATUS (R) ;/                        |
+-----------------------------------------------------------------------+
```

In hw2, this register appears to be mirrored to 0040F4h (without ENABLE
flag in bit20) and 028244h (bit ENABLED flag in bit20).

**ATH:0040F8h/0040F8h/005040h - MAC_PCU_SLP32_WAKE ;hw2/hw4/hw6**
**ATH:028248h (mirror of 0040F8h) - MAC_PCU_REG_SLP32_WAKE (ini:07EFh)
;hw2**

```
+-----------------------------------------------------------------------+
|       0-15   XTL_TIME                                                 |
+-----------------------------------------------------------------------+
```


**ATH:0040FCh/0040FCh/005044h - MAC_PCU_SLP32_INC ;hw2/hw4/hw6**
**ATH:02824Ch (mirror of 0040FCh) - MAC_PCU_REG_SLP32_TSF_INC
(ini:1E848h) ;hw2**

```
+-----------------------------------------------------------------------+
|       0-19   TSF_INC                                                  |
+-----------------------------------------------------------------------+
```


**ATH:004100h/004100h/005048h - MAC_PCU_SLP_MIB1 ;hw2/hw4/hw6**
**ATH:028250h (mirror of 004100h) - MAC_PCU_REG_SLPMIB1 ;hw2**

```
+-----------------------------------------------------------------------+
|       0-31   SLEEP_CNT                                                |
+-----------------------------------------------------------------------+
```


**ATH:004104h/004104h/00504Ch - MAC_PCU_SLP_MIB2 ;hw2/hw4/hw6**
**ATH:028254h (mirror of 004104h) - MAC_PCU_REG_SLPMIB2 ;hw2**

```
+-----------------------------------------------------------------------+
|       0-31   CYCLE_CNT                                                |
+-----------------------------------------------------------------------+
```


**ATH:004108h/004108h/005050h - MAC_PCU_SLP_MIB3 ;hw2/hw4/hw6**
**ATH:028258h (mirror of 004108h) - MAC_PCU_REG_SLPMIB3 ;hw2**

```
+-----------------------------------------------------------------------+
|       0      CLR_CNT                                                  |
|       1      PENDING                    (R)                           |
+-----------------------------------------------------------------------+
```

In hw2, this register appears to be mirrored to 004108h (with bit1
called \"PENDING\") and 028258h (with bit1 called \"PEND\" for whateve
reason).

**ATH:0280D4h/004204h/0050C0h - MAC_PCU_SLP1 ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-                                                              |
| 18   hw2: outcommented: NEXT_DTIM)   (hw2: ini:2AAAAh) ;\outcommented 
|       20     hw2: outcommented: ENH_SLEEP_ENABLE) (hw2: ini:1) ;/     |
|                                                                       |
|    0-4    hw2/hw6: CAB_TIMEOUT_EXT             (hw2: ini:0) ;-hw2/hw6 |
|       0-15   hw4: CAB_TIMEOUT                                  ;-hw4  |
|       1                                                               |
| 9     ASSUME_DTIM                          (hw2: ini:0) ;-hw2/hw4/hw6 |
|       20     hw6: BUG_59985_FIX_ENABLE                         ;-hw6  |
|                                                                       |
|    21-31  hw2/hw6: CAB_TIMEOUT                 (hw2: ini:5) ;-hw2/hw6 |
+-----------------------------------------------------------------------+
```


**ATH:0280D8h/004208h/0050C4h - MAC_PCU_SLP2 ;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|                                                                       |
|  0-18   hw2: outcommented: NEXT_TIM  (hw2: ini:55555h) ;-outcommented |
|       0-15   hw4: BEACON_TIMEOUT                            ;-hw4     |
|       0-4    hw2/hw6: BEACON_TIMEOUT_EXT  (hw2: ini:0)      ;\hw2/hw6 
|       21-31  hw2/hw6: BEACON_TIMEOUT      (hw2: ini:2)      ;/        |
+-----------------------------------------------------------------------+
```


**ATH:0280DCh - (outcommented) ;aka MAC_PCU_REG_SLP3 ;hw2 (but
outcommented)**

```
+-----------------------------------------------------------------------+
|                                                                       |
|  0-15   hw2: outcommented: TIM_PERIOD  (hw2: ini:2)    ;\outcommented 
|       16-31  hw2: outcommented: DTIM_PERIOD (hw2: ini:3)    ;/        |
+-----------------------------------------------------------------------+
```


**ATH:028260h/0050C8h - MAC_PCU_SLP3 ;hw2/hw6**

```
+-----------------------------------------------------------------------+
|       0-15   hw2/hw6: CAB_AWAKE_DUR        (hw2: ini:0005h) ;\hw2/hw6 
|       16     hw2/hw6: CAB_AWAKE_ENABLE     (hw2: ini:0)     ;/        |
+-----------------------------------------------------------------------+
```


**ATH:0050CCh - MAC_PCU_SLP4 ;hw6**

```
+-----------------------------------------------------------------------+
|       0-15   hw6: BEACON2_TIMEOUT                                     |
|       16-30  hw6: CAB2_TIMEOUT                                        |
|       31     hw6: ASSUME_DTIM2                                        |
+-----------------------------------------------------------------------+
```



```
+-----------------------------------------------------------------------+
|      _______                                                          |
| _______________________ Generic Timers ______________________________ |
+-----------------------------------------------------------------------+
```


- **ATH:028200h..02821Ch - MAC_PCU_REG_GNRCTMR_N\[0..7\] ;hw2**
- **ATH:028220h..02823Ch - MAC_PCU_REG_GNRCTMR_P\[0..7\] ;hw2**
- **ATH:004140h..417Ch/005064h..50A0h - MAC_PCU_GENERIC_TIMERS\[0..15\
;hw4/hw6**
- **ATH:0041C0h..41FCh/0050DCh..5118h - MAC_PCU_GENERIC_TIMERS2\[0..15\
;hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-31   hw2, for "GNRCTMR_N" entries: GNRCTMR_N (32bit)          |
|                                                                       |
|      0-27   hw2, for "GNRCTMR_P" entries: GNRCTMR_P (only 28bit here) |
|       0-31   hw4/hw6: DATA (32bit)                                    |
+-----------------------------------------------------------------------+
```

Unknown how that stuff is related\...

```
+-----------------------------------------------------------------------+
|       - hw2   has "8xTMR_N"  plus "8xTMR_P"                           |
|       - hw4/6 has "16xTIMER" plus "16xTIMER2"                         |
+-----------------------------------------------------------------------+
```

maybe TIMER and TIMER2 are equivalent to TMR_N and TMR_P, or maybe TIMER
is meant to contain \"eight N+P pairs\" (and TIMER2 another eigh
pairs), or maybe the \"N\" and \"P\" stuff was completely dropped i
hw4/hw6. The ENABLE bits are also weird:

```
+-----------------------------------------------------------------------+
|       - hw2 has 1x8 ENABLE bits  (for 8+8 timer entries)              |
|       - hw4 has 2x16 ENABLE bits (for 16+16 timer entries)            |
|       - hw6 has 2x8 ENABLE bits  (for 16+16 timer entries, too)       |
+-----------------------------------------------------------------------+
```

Note that hw2 has the generic timers in the WMAC PCU area at 028xxxh.

**ATH:028240h/004180h/0050BCh - MAC_PCU_GENERIC_TIMERS_MODE
;hw2/hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-                                                              |
| 15   hw4: ENABLE         (16bit)            ;\hw4 (the other bits are 
|       16-                                                             |
| 31  hw4: -                                 ;/moved to "MODE3" in hw4) |
|       0-7    hw6: ENABLE         (8bit)             ;\                
|       8-10   hw6: OVERFLOW_INDEX (3bit)        (R)  ; hw2/hw6         |
|       11     hw6: -                                 ;                 |
|       12-31  hw6: THRESH         (20bit)            ;/                |
+-----------------------------------------------------------------------+
```


**ATH:004200h/005134h - MAC_PCU_GENERIC_TIMERS_MODE2 ;hw4/hw6 (not
hw2)**

```
+-----------------------------------------------------------------------+
|       0-15   hw4: ENABLE          (16bit)           ;-hw4             |
|       0-7    hw6: ENABLE          (8bit)            ;\                
|       8-11   hw6: OVERFLOW_INDEX  (4bit)        (R) ; hw6             |
|       12-15  hw6: OVERFLOW_INDEX2 (4bit)        (R) ;/                |
+-----------------------------------------------------------------------+
```


**ATH:0042D4h - MAC_PCU_GENERIC_TIMERS_MODE3 ;hw4 only**

```
+-----------------------------------------------------------------------+
|       0-19                                                            |
|   hw4: THRESH                    ;\hw4 only (in hw2/hw6 this stuff is 
|       24-27  h                                                        |
| w4: OVERFLOW_INDEX            ;/located in "MODE" instead of "MODE3") |
+-----------------------------------------------------------------------+
```


**ATH:005150h - MAC_PCU_GENERIC_TIMERS_TSF_SEL ;hw6 only**

```
+-----------------------------------------------------------------------+
|       0-15   VALUE                                                    |
+-----------------------------------------------------------------------+
```



```
+-----------------------------------------------------------------------+
|      ______                                                           |
| ____________________ below in hw4/hw6 only __________________________ |
+-----------------------------------------------------------------------+
```


**ATH:004118h/005148h - WLAN_HT (aka HT) ;hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0      MODE                                                     |
+-----------------------------------------------------------------------+
```


**ATH:00411Ch/005054h - MAC_PCU_TSF_L32 ;hw4/hw6 (hw2: see
REG_TSF_L32)**
**ATH:004120h/005058h - MAC_PCU_TSF_U32 ;hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-63   VALUE                                                    |
+-----------------------------------------------------------------------+
```


**ATH:0042CCh/0050D4h - MAC_PCU_TSF2_L32 ;hw4/hw6**
**ATH:0042D0h/0050D8h - MAC_PCU_TSF2_U32 ;hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-63   VALUE                                                    |
+-----------------------------------------------------------------------+
```


**ATH:00505Ch - MAC_PCU_WBTIMER_0 ;hw6**

```
+-----------------------------------------------------------------------+
|       0      ENABLE                                 ;-hw6 only        |
+-----------------------------------------------------------------------+
```


**ATH:004124h/005060h - MAC_PCU_WBTIMER_1 (aka MAC_PCU_WBTIMER)
;hw4/hw6**

```
+-----------------------------------------------------------------------+
|       0-31   VALUE                                                    |
+-----------------------------------------------------------------------+
```


**ATH:00420Ch/0050D0h - MAC_PCU_RESET_TSF ;hw4/hw6**

```
+-----------------------------------------------------------------------+
|       24                                                              |
|  ONE_SHOT    ;aka "one shot RESET_TSF"   ;<-- see "REG_BEACON" in hw2 |
|       25     ONE_SHOT2                                                |
+-----------------------------------------------------------------------+
```


**ATH:00427Ch/005154h - MAC_PCU_BMISS_TIMEOUT ;hw4/hw6**
**ATH:005158h - MAC_PCU_BMISS2_TIMEOUT ;hw6 only**

```
+-----------------------------------------------------------------------+
|       0-23   VALUE  (aka BMISS_TIMEOUT)                               |
|       24     ENABLE (aka BMISS_TIMEOUT_ENABLE)                        |
+-----------------------------------------------------------------------+
```



```
+-----------------------------------------------------------------------+
|      ______                                                           |
| ______________________ below in hw2 only ____________________________ |
+-----------------------------------------------------------------------+
```


**ATH:00410Ch - MAC_PCU_SLP_BEACON - hw2 only (removed or renamed in
hw4)**
**ATH:028264h (mirror of 00410Ch) - MAC_PCU_REG_SLP5 (ini: 0FFFFFFh)
;hw2**

```
+-----------------------------------------------------------------------+
|       0-23   hw2: BMISS_TIMEOUT                  ;\hw2 only           
|       24     hw2: BMISS_TIMEOUT_ENABLE           ;/                   |
+-----------------------------------------------------------------------+
```

See also: - MAC_PCU_BMISS_TIMEOUT \<\-\-- is that equivalent o
hw4/hw6!?!

- **ATH:004120h..413Ch - SDIO_SETUP_CIRCUIT\[8\] - hw2 only (removed i
hw4/hw6)**
- **ATH:004160h..417Ch - CPU_SETUP_CIRCUIT\[8\] - hw2 only (removed i
hw4/hw6)**
- **ATH:0041A0h..41BCh - BB_SETUP_CIRCUIT\[8\] - hw2 only (removed i
hw4/hw6)**

```
+-----------------------------------------------------------------------+
|       0-7    hw2: VECTOR                                              |
+-----------------------------------------------------------------------+
```


**ATH:004140h - SDIO_SETUP_CONFIG - hw2 only (removed in hw4/hw6)**
**ATH:004144h - CPU_SETUP_CONFIG - hw2 only (removed in hw4/hw6)**
**ATH:004180h - BB_SETUP_CONFIG - hw2 only (removed in hw4/hw6)**

```
+-----------------------------------------------------------------------+
|       0      hw2: CLEAR                                               |
|       1      hw2: ENABLE                                              |
+-----------------------------------------------------------------------+
```



```
+-----------------------------------------------------------------------+
|      ______                                                           |
| ______________________ below in hw4 only ____________________________ |
+-----------------------------------------------------------------------+
```


**ATH:004210h - MAC_PCU_TSF_ADD_PLL ;hw4**

```
+-----------------------------------------------------------------------+
|       0-7    hw4: VALUE                                               |
+-----------------------------------------------------------------------+
```


**ATH:004280h - MAC_PCU_CAB_AWAKE ;hw4**

```
+-----------------------------------------------------------------------+
|       0-15   hw4: DURATION                                            |
|       16     hw4: ENABLE                                              |
+-----------------------------------------------------------------------+
```


**ATH:0042D8h - MAC_PCU_DIRECT_CONNECT ;hw4**

```
+-----------------------------------------------------------------------+
|       0      hw4: AP_STA_ENABLE                                       |
|       1      hw4: AP_TSF_1_2_SEL                                      |
|       2      hw4: STA_TSF_1_2_SEL                                     |
+-----------------------------------------------------------------------+
```


**ATH:004218h..004278h - Bluetooth Coex related ;hw4**
**ATH:004294h..0042A4h - Bluetooth Coex related, too? ;hw4**
These hw4 ports have been moved to 007xxxh in hw6. See Bluetooth Coex
chapter for details.


```
+-----------------------------------------------------------------------+
|      ______                                                           |
| ______________________ below in hw6 only ____________________________ |
+-----------------------------------------------------------------------+
```


**ATH:005000h - WLAN_RESET_CONTROL ;hw6**

```
+-----------------------------------------------------------------------+
|       0      MAC_WARM_RST           ;-moved from 004000h.bit4   ;\    
|       1      MAC_COLD_RST           ;-moved from 004000h.bit5   ;     |
|       2      WARM_RST               ;-moved from 004000h.bit7   ;     |
|       3      COLD_RST               ;-also in 004000h.bit8      ;     |
|       4      BB_WARM_RST            ;-moved from 004000h.bit12  ;     |
|       5      BB_COLD_RST            ;-moved from 004000h.bit13  ;/    |
|       6      RADIO_SRESET           ;-new hw6 bit               ;\    
|       7      MCI_RESET              ;-new hw6 bit               ;/    |
+-----------------------------------------------------------------------+
```


**ATH:005008h - WLAN_REG_CONTROL0 ;hw6**

```
+-----------------------------------------------------------------------+
|       0-31   SWREG_BITS                                               |
+-----------------------------------------------------------------------+
```


**ATH:00500Ch - WLAN_REG_CONTROL1 ;hw6**

```
+-----------------------------------------------------------------------+
|       0      SWREG_PROGRAM                                            |
|       1-2    OTPREG_LVL                                               |
+-----------------------------------------------------------------------+
```


**ATH:005028h - WLAN_RESET_CAUSE ;hw6 ;\<\-\-- mirror o
SOC_RESET_CAUSE?**

```
+-----------------------------------------------------------------------+
|       0-2    LAST                           (R)                       |
+-----------------------------------------------------------------------+
```


**ATH:00502Ch - WLAN_SYSTEM_SLEEP ;hw6 ;\<\--partial mirror o
SOC_SYSTEM_SLEEP?**

```
+-----------------------------------------------------------------------+
|       0      DISABLE                                                  |
|       1      LIGHT                                                    |
|       2      MAC_IF                         (R)                       |
+-----------------------------------------------------------------------+
```


**ATH:00515Ch - RTC_AXI_AHB_BRIDGE ;hw6 only**

```
+-----------------------------------------------------------------------+
|       0-1    hw6: MAX_BEATS                                           |
+-----------------------------------------------------------------------+
```


**ATH:005160h - UNIFIED_MAC_REVID (R) ;hw6 only**

```
+-----------------------------------------------------------------------+
|       0-31   hw6: VALUE                          (R)                  |
+-----------------------------------------------------------------------+
```





